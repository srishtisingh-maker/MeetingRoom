<div class="content-card">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>My Bookings</h3>
    <button class="btn btn-primary" (click)="openCreate()">+ New Booking</button>
  </div>

  <table class="table table-hover">
    <thead class="table-dark">
      <tr>
        <th>Room</th>
        <th>Date</th>
        <th>Time</th>
        <th>Participants</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let b of bookings">
        <td>{{ b.roomName }}</td>
        <td>{{ b.date | date }}</td>
        <td>{{ b.startTime }} - {{ b.endTime }}</td>
        <td>{{ b.participants }}</td>
        <td>
          <span class="badge"
            [ngClass]="{
              'bg-warning': b.status === 'Pending',
              'bg-success': b.status === 'Approved',
              'bg-danger': b.status === 'Rejected',
              'bg-secondary': b.status === 'Cancelled'
            }">
            {{ b.status }}
          </span>
        </td>
        <td>
          <button
            class="btn btn-sm btn-outline-primary me-1"
            (click)="openEdit(b)"
            [disabled]="b.status !== 'Pending'">
            Edit
          </button>

          <button
            class="btn btn-sm btn-outline-danger"
            (click)="cancelBooking(b.id)"
            [disabled]="b.status !== 'Pending'">
            Cancel
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Create / Edit Modal -->
<div class="modal fade show d-block" *ngIf="showForm">
  <div class="modal-dialog">
    <div class="modal-content p-3">
      <h5>{{ isEdit ? 'Update Booking' : 'New Booking' }}</h5>

      <!-- Room only for Create -->
      <div *ngIf="!isEdit">
        <label>Room ID</label>
        <input type="number"
               class="form-control mb-2"
               [(ngModel)]="formModel.roomId">
      </div>

      <label>Date</label>
      <input type="date"
             class="form-control mb-2"
             [(ngModel)]="formModel.date">

      <label>Start Time</label>
      <input type="time"
             class="form-control mb-2"
             [(ngModel)]="formModel.startTime">

      <label>End Time</label>
      <input type="time"
             class="form-control mb-2"
             [(ngModel)]="formModel.endTime">

      <label>Participants</label>
      <input type="number"
             class="form-control mb-3"
             [(ngModel)]="formModel.participants">

      <div class="text-end">
        <button class="btn btn-secondary me-2" (click)="reset()">Cancel</button>
        <button class="btn btn-primary" (click)="save()">Save</button>
      </div>
    </div>
  </div>
</div>
